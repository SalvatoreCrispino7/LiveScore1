<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="/static/sticky.css">
    <link rel="stylesheet" href="\static\dettagli_futuri.css">
    <link rel="icon" type="image/vnd.icon" href="/assets/football.ico">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <title>DETTAGLI MATCH</title>
</head>
<body>
    <h1>âš½ DETTAGLI MATCH</h1>
    
    <div class="sticky-bar">
        <a href="/live" class="live">LIVE</a>
        <a href="/future" class="oggi">OGGI</a>
    </div>
    
    <div id="output" class="detail-container">
        <p class="no-data">Caricamento dati...</p>
    </div>

    <script>
        let socket = new WebSocket("ws://localhost:8888/ws");
        socket.onopen = () => console.log("âœ… WebSocket aperto");
        socket.onmessage = (event) => {
            const data = JSON.parse(event.data);
            const match_id = new URLSearchParams(window.location.search).get('match_id');
            const output = document.getElementById("output");
            
            for (const item of data.future) {
                if (item.match_id === match_id) {
                    output.innerHTML = "";  // Pulisci
                    
                    // Info principali
                    const infoCard = document.createElement("div");
                    infoCard.className = "info-card";
                    infoCard.innerHTML = `
                        <div style="text-align:center;">
                            <strong>ğŸ† ${item.match_hometeam_name} vs ${item.match_awayteam_name}</strong><br>
                            ğŸ“… ${item.match_date} â° ${item.match_time}
                        </div>
                    `;

                    output.appendChild(infoCard);
                    
                    // Stadio
                    if (item.match_stadium) {
                        const stadiumBadge = document.createElement("span");
                        stadiumBadge.className = "stadium-badge";
                        stadiumBadge.textContent = `ğŸŸï¸ ${item.match_stadium}`;
                        output.appendChild(stadiumBadge);
                    }
                    
                    // Fase
                    if (item.stage_name && item.stage_name !== "Current") {
                        const phaseBadge = document.createElement("span");
                        phaseBadge.className = "phase-badge";
                        phaseBadge.textContent = `ğŸ† ${item.stage_name}`;
                        output.appendChild(phaseBadge);
                    }
                    
                    // Badge squadre
                    const badgesDiv = document.createElement("div");
                    badgesDiv.className = "team-badges";
                    const imgHome = document.createElement("img"); 
                    imgHome.src = item.team_home_badge || "/assets/no_logo.png";
                    const imgAway = document.createElement("img"); 
                    imgAway.src = item.team_away_badge || "/assets/no_logo.png";
                    badgesDiv.append(imgHome, imgAway);
                    output.appendChild(badgesDiv);
                    console.log(item);
                    break;
                }
            }
        };
    </script>
</body>
</html>